Turbo Assembler	 Version 4.1	    02/13/24 21:27:09	    Page 1
prog.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     .286
      4				     org 100h
      5
      6	0100			     Start:
      7	0100  1E				 push ds
      8	0101  07				 pop es
      9
     10	0102  BF 0110r				 mov di, offset	X
     11	0105  E8 000D				 call Strlen
     12
     13	0108  E8 0018				 call PrnW
     14
     15	010B  B8 4C13				 mov ax, 4c13h
     16	010E  CD 21				 int 21h
     17
     18	0110  74 65 73 74 24	     X db 'test$'
     19
     20				     ;-------------------------------------------
     21				     ; Strlen
     22				     ; Description:
     23				     ;	 Counts	string's len.
     24				     ; Result:
     25				     ;	 In AX.
     26				     ; Assumes:
     27				     ;	 String's address is in	ES:DI. Terminating
     28				     ;	 symbol	is '$'.
     29				     ; ATTENTION:
     30				     ;	 UB if string's	len is more than a word's
     31				     ;	 max value.
     32				     ; DESTROYS:
     33				     ;	 AX, CX
     34				     ;-------------------------------------------
     35	0115			     Strlen	 proc
     36
     37	      =FFFF		     STRLEN_CX_DEF_VAL equ 0FFFFh
     38
     39	0115  B0 24				 mov al, '$'
     40	0117  B9 FFFF				 mov cx, STRLEN_CX_DEF_VAL
     41	011A  F2> AE				 repne scasb
     42
     43	011C  B8 FFFF				 mov ax, STRLEN_CX_DEF_VAL
     44	011F  2B C1				 sub ax, cx
     45	0121  48				 dec ax
     46
     47	0122  C3				 ret
     48	0123					 endp
     49				     ;-------------------------------------------
     50
     51				     include prnw.asm
1    52				     ;-------------------------------------------
1    53				     ; PrnW
1    54				     ; Description:
1    55				     ;	 Prints	to standart output AX
1    56				     ;	 in hex	(using int 21h (02h))
1    57				     ; DESTROYS:
Turbo Assembler	 Version 4.1	    02/13/24 21:27:09	    Page 2
prog.asm



1    58				     ;	 CX, DX
1    59				     ;-------------------------------------------
1    60	0123			     PrnW	 proc
1    61
1    62	0123  BE 0003				 mov si, 3h	     ; starting	from smallest bytes,
1    63								     ; which are in the	rightmost character
1    64
1    65						 ; loop	start
1    66	0126  B9 0004				 mov cx, 4h	     ; rotating	ax 4 times
1    67	0129  8A D0		     PrnWL:	 mov dl, al
1    68	012B  80 E2 0F				 and dl, 00001111b
1    69	012E  80 FA 0A				 cmp dl, 10d
1    70	0131  7D 05				 jge PrnWLtr
1    71
1    72	0133  80 C2 30				 add dl, '0' ; '0' ... '9'
1    73	0136  EB 06				 jmp short PrnWFin
1    74
1    75	0138  80 C2 41		     PrnWLtr:	 add dl, 'A' ; 'A' ... 'F'
1    76	013B  80 EA 0A				 sub dl, 0Ah
1    77
1    78	013E  88 94 0152r	     PrnWFin:	 mov byte ptr [PrnWData	+ si], dl
1    79	0142  C1 C8 04				 ror ax, 4
1    80	0145  4E				 dec si
1    81	0146  E2 E1				 loop PrnWL
1    82						 ; loop	end
1    83
1    84						 ; printing
1    85	0148  50				 push ax		 ; saving ax
1    86	0149  BA 0152r				 mov dx, offset	PRNWDATA
1    87	014C  B4 09				 mov ah, 09h
1    88	014E  CD 21				 int 21h
1    89	0150  58				 pop ax			 ; ressurecting	ax
1    90
1    91						 ; end
1    92	0151  C3				 ret
1    93	0152					 endp
1    94
1    95	0152  ?? ?? ?? ?? 24	     PrnWData	 db ?, ?, ?, ?,	'$'
1    96				     ;-------------------------------------------
1    97
     98
     99				     end	 Start
Turbo Assembler	 Version 4.1	    02/13/24 21:27:09	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/13/24"
??FILENAME			  Text	 "prog	  "
??TIME				  Text	 "21:27:09"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0707H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 PROG
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
PRNW				  Near	 DGROUP:0123
PRNWDATA			  Byte	 DGROUP:0152
PRNWFIN				  Near	 DGROUP:013E
PRNWL				  Near	 DGROUP:0129
PRNWLTR				  Near	 DGROUP:0138
START				  Near	 DGROUP:0100
STRLEN				  Near	 DGROUP:0115
STRLEN_CX_DEF_VAL		  Number FFFF
X				  Byte	 DGROUP:0110

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0157 Word	  Public  CODE
